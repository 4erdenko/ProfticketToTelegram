# Profticket To Telegram ‚Äî –±–æ—Ç —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω–æ–π –∞—Ñ–∏—à–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

![Python](https://img.shields.io/badge/Python-3.11-blue)
![Aiogram](https://img.shields.io/badge/Aiogram-3.x-0aa)
![Ruff](https://img.shields.io/badge/Ruff-lint%20%26%20format-ff69b4)
![Tests](https://img.shields.io/badge/Tests-pytest-informational)
![Docker](https://img.shields.io/badge/Docker-compose-blue)
![License](https://img.shields.io/badge/License-MIT-green)

–†—É—Å—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è. For English version see README.en.md.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- Docker
- –¢–µ—Å—Ç—ã –∏ –ª–∏–Ω—Ç–∏–Ω–≥
- –ö–æ–º–∞–Ω–¥—ã –∏ –º–µ–Ω—é
- –õ–æ–≥–∏
- –í–∫–ª–∞–¥
- –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞
- –õ–∏—Ü–µ–Ω–∑–∏—è –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

Telegram‚Äë–±–æ—Ç –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å–ø–µ–∫—Ç–∞–∫–ª–µ–π/—Å–æ–±—ã—Ç–∏–π –∏–∑ Profticket –∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
–ø—Ä–æ–¥–∞–∂. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ –∞—Ä—Ç–∏—Å—Ç–∞–º) –∏
–∞–¥–º–∏–Ω‚Äë–ø–∞–Ω–µ–ª—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é: –≤—ã–±–æ—Ä –º–µ—Å—è—Ü–∞, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä ¬´üë§–í—ã–±—Ä–∞—Ç—å –∞–∫—Ç—ë—Ä–∞/–∞–∫—Ç—Ä–∏—Å—É¬ª,
  –ø–µ—Ä–µ—Ö–æ–¥ –≤ ¬´üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞¬ª.
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑—ã: —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å —É—á–∞—Å—Ç–∏–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∞—Ä—Ç–∏—Å—Ç–∞.
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞:
  - üèÜ –¢–æ–ø –ø—Ä–æ–¥–∞–∂ (—Å–ø–µ–∫—Ç–∞–∫–ª–∏) ‚Äî –≤–∞–ª–æ–≤—ã–µ/—á–∏—Å—Ç—ã–µ –ø—Ä–æ–¥–∞–∂–∏;
  - ‚ö°Ô∏è –¢–æ–ø —Å–∫–æ—Ä–æ—Å—Ç–∏ (—Å–ø–µ–∫—Ç–∞–∫–ª–∏) ‚Äî —Ç–µ–∫—É—â–∏–π —Ç–µ–º–ø –ø—Ä–æ–¥–∞–∂;
  - ‚è≥ –ü—Ä–æ–≥–Ω–æ–∑ Sold Out ‚Äî –±–ª–∏–∂–∞–π—à–∏–µ sold out;
  - üé≠ –¢–æ–ø –ø—Ä–æ–¥–∞–∂ (–∞—Ä—Ç–∏—Å—Ç—ã);
  - üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø—Ä–æ–¥–∞–∂ ‚Äî –ø–æ –¥–∞—Ç–∞–º; 
  - üîÑ –¢–æ–ø –ø–æ –≤–æ–∑–≤—Ä–∞—Ç–∞–º –∏ üìâ –¢–æ–ø –ø–æ % –≤–æ–∑–≤—Ä–∞—Ç–æ–≤.
- –î–ª–∏–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–∏ (¬´—á–∞–Ω–∫–∏¬ª) ‚Äî –Ω–µ —É–ø–∏—Ä–∞—é—Ç—Å—è –≤ –ª–∏–º–∏—Ç—ã Telegram.
- –ê–¥–º–∏–Ω‚Äë–ø–∞–Ω–µ–ª—å (üõ† –ê–¥–º–∏–Ω–∫–∞):
  - üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî —Å–≤–æ–¥–∫–∞/—Ç–æ–ø—ã, –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∞—Ä—Ç–∏—Å—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
  - üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —Ä–æ–ª–∏, —Ç–æ–ø—ã –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º/—Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥—É;
  - üé≠ –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è ‚Äî —Ç–æ–ø –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∞—Ä—Ç–∏—Å—Ç–æ–≤, –ø—Ä–∏–º–µ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π,
    —Å–ø–∏—Å–æ–∫ –±–µ–∑ –≤—ã–±–æ—Ä–∞;
  - üóÑ –ë–∞–∑–∞ (—à–æ—É) ‚Äî –º–µ—Ç—Ä–∏–∫–∏ –ø–æ shows/–∏—Å—Ç–æ—Ä–∏–∏ –º–µ—Å—Ç, —Å–≤–µ–∂–µ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.

–ê–¥–º–∏–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ `ADMIN_ID` –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å `User.admin=True`.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- `main.py` ‚Äî –∑–∞–ø—É—Å–∫, middlewares, —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.
- `telegram/` ‚Äî —Ö–µ–Ω–¥–ª–µ—Ä—ã, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, —Ñ–∏–ª—å—Ç—Ä—ã, middlewares, —É—Ç–∏–ª–∏—Ç—ã.
- `services/profticket/` ‚Äî –∫–ª–∏–µ–Ω—Ç –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ Profticket.
- `alembic/` ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î; `alembic.ini` ‚Äî –∫–æ–Ω—Ñ–∏–≥ Alembic.
- `tests/` ‚Äî pytest‚Äë—Ç–µ—Å—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ —É—Ç–∏–ª–∏—Ç.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11
- PostgreSQL 14+

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1) –°–æ–∑–¥–∞–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```
python -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt
```

2) –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:
```
cp .env.example .env
```

3) (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```
alembic upgrade head
```

4) –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```
python main.py
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–º. `.env.example`. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω—É–∂–Ω—ã: `BOT_TOKEN`/`TEST_BOT_TOKEN`, `ADMIN_ID`,
`DB_URL`, `COM_ID`, `DEFAULT_TIMEZONE`. –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ Docker —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ
`IN_DOCKER=true` ‚Äî —Ç–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `BOT_TOKEN`.

## Docker

–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:
```
docker-compose up -d
```
–ü–æ–¥–Ω–∏–º–µ—Ç Postgres –∏ –±–æ—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## –¢–µ—Å—Ç—ã –∏ –ª–∏–Ω—Ç–∏–Ω–≥

```
pytest -q
ruff format . && ruff check --fix .
```

–¢–µ—Å—Ç—ã –±—ã—Å—Ç—Ä—ã–µ, —Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã –∑–∞–º–æ–∫–∞–Ω—ã.

## –ö–æ–º–∞–Ω–¥—ã –∏ –º–µ–Ω—é

- –ù–∞—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é (—Å–º. `telegram/keyboards/native_menu.py`): `/start`, `/help`,
  `/set_actor`, `/analytics`.
- –¢–µ–∫—Å—Ç—ã –∫–Ω–æ–ø–æ–∫ ‚Äî `telegram/lexicon/lexicon_ru.py`.

## –õ–æ–≥–∏

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `telegram/utils/startup.py` (`setup_logging`), –≤—ã–≤–æ–¥—è—Ç—Å—è –≤
stdout —á–µ—Ä–µ–∑ `coloredlogs` –Ω–∞ —É—Ä–æ–≤–Ω–µ INFO.

## –í–∫–ª–∞–¥

–ü–µ—Ä–µ–¥ PR –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ:
- `ruff format . && ruff check --fix .`
- `pytest -q`
- –°–æ–±–ª—é–¥–∞–π—Ç–µ Conventional Commits (–Ω–∞–ø—Ä–∏–º–µ—Ä: `feat(telegram): ...`).
- –ù–µ –≤–∫–ª—é—á–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–º–º–∏—Ç—ã; –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env`.

## –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω‚Äë–æ—Ç—á—ë—Ç–∞—Ö –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ.
- –≠–∫—Å–ø–æ—Ä—Ç CSV –¥–ª—è –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π/—Ç–æ–ø–æ–≤.
- –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (id/username) –∏ –±—ã—Å—Ç—Ä–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏/–±–∞–Ω–æ–º –∏–∑ –∞–¥–º–∏–Ω‚Äë–º–µ–Ω—é.

## –õ–∏—Ü–µ–Ω–∑–∏—è –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

–õ–∏—Ü–µ–Ω–∑–∏—è ‚Äî MIT (—Å–º. `LICENSE`). –í–æ–ø—Ä–æ—Å—ã: —Å–º. `ADMIN_USERNAME` –≤ `.env`.
